@page "/MyConverterMaybe"
@using BlazorAppMaybePoc.Shared.Functional

<h3>Temperature Converter Using Maybe()</h3>

<div>
    <input type="number" @bind="_inputValue" placeholder="Enter value"/>
    <select @bind="_conversionType">
        <option value="FtoC">Fahrenheit to Celsius</option>
        <option value="CtoF">Celsius to Fahrenheit</option>
    </select>
    <button @onclick="ConvertTemperature">Convert</button>
</div>

@if (_result is not null)
{
    <p>Result: @_result</p>
}

@code {
    private decimal _inputValue;
    private string _conversionType = "FtoC";
    private string? _result;

    private async void ConvertTemperature()
    {
        var conversionResult = _conversionType switch
        {
            "FtoC" => TemperatureConversionServiceMonad.FahrenheitToCelsius(_inputValue),
            "CtoF" => await TemperatureConversionServiceMonad.CelsiusToFahrenheitAsync(_inputValue),
            _ => new Error<string>(new InvalidOperationException("Invalid conversion type"))
        };

        _result = conversionResult switch
        {
            Nothing<string> _ => "No result could be calculated.",
            Something<string> s => s.Value,
            Error<string> e => $"An error occurred: {e.ErrorMessage.Message}",
            _ => "An unknown error occurred"
        };
    }

}